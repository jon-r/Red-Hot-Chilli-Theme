/*! Jon Richards 2015 | GPL-2.0+ | http://www.gnu.org/licenses/gpl-2.0.txt
 * INCLUDES
 * Jquery Menu Aim | https://github.com/kamens/jQuery-menu-aim
 * Get Viewport Dimensions | http://andylangton.co.uk/blog/development/get-viewport-size-width-and-height-javascript
!*/
function updateViewportDimensions(){var e=window,i=document,t=i.documentElement,r=i.getElementsByTagName("body")[0],l=e.innerWidth||t.clientWidth||r.clientWidth,a=e.innerHeight||t.clientHeight||r.clientHeight;return{width:l,height:a}}function showSubMenu(e){bigScreen&&($row=$(e),$row.addClass("active-li"))}function hideSubMenu(e){$row=$(e),$row.removeClass("active-li")}function hideAllMenus(){bigScreen=!1,$navMain_li=$navMain_ul.find("li").removeClass("active-li")}function ticker(){console.log("tick"),hoverLock||timerLock||(tickerInt=tickerInt==slideCount?0:tickerInt+1,timerLock=!0,slideActivate(tickerInt))}function slideActivate(e){$carousel.find(".go-away").removeClass("is-active").removeClass("go-away"),$carousel.find(".is-active").addClass("go-away"),$slide.eq(e).removeClass("go-away").addClass("is-active"),$tabs.removeClass("active").eq(e).addClass("active"),setTimeout(function(){timerLock=!1},600)}function searchToText(e){var i=$.parseJSON(e);$searchOut.html(""),$(i).each(function(e){if(4>e){var i=fileSrc.site+"/products/"+this.filter+"/"+this.url+"/",t="brand"==this.filter?"<span> - Brand</span>":"<span> - Category</span>",r='<li><a href="'+i+'" >'+this.name+t+"</a></li>";$searchOut.append(r)}})}function searchTraverse(e,i){$results=$searchOut.find("li > a"),$resultCount=$results.length,"down"==e&&i<$resultCount-1?(i++,$target=$results.eq(i),$text=$target.text(),$searchIn.val($text)):"up"==e&&(i>0?(i--,$target=$results.eq(i),$text=$target.text(),$searchIn.val($text)):$target=$searchIn),$target.focus(),console.log(i)}function setMainImg(e){$thumbImg=$imgGalleryThumb.eq(e).find("img"),$getThumbSrc=$thumbImg.attr("src").replace("gallery-thumb","gallery").split("/").slice(-3).join("/"),$fullThumbSrc="../"+$getThumbSrc,$imgGalleryMain.addClass("loading"),1==$thumbImg.data("tile")?$imgGalleryMain.removeClass("loading").find("img").attr("src",fileSrc.site+"/"+$getThumbSrc):($.get(fileSrc.admin,{src:$fullThumbSrc,size:"tile",action:"jr_resize"},replaceMainImg),$thumbImg.data("tile",1))}function replaceMainImg(e){var i=$.parseJSON(e);$newSrc=i.replace("../",fileSrc.site+"/"),$imgGalleryMain.removeClass("loading").find("img").attr("src",$newSrc)}function modalOpen(e){e.addClass("is-active")}function modalOpenSmall(e){e.addClass("is-active-small")}function modalClose(e){e.removeClass("is-active"),e.removeClass("is-active-small")}function questionToText(e){var i=$.parseJSON(e);$queryModaloutput.removeClass("loading").html(i.answer).next("button").html(i.next)}function formValidate(e){var i=e.val(),t=e.attr("name"),r=e.attr("type"),l=i.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/),a="";$formInputsReq.index(e);e.removeClass("error").removeClass("success").next("span").empty(),"email"!=r||l||(a="Please enter a valid email address",e.addClass("error")),i.length<1&&(a="Your "+t+" is required"),a.length>0?(e.addClass("error").next("span").text(a),formErrorList.push(a)):e.addClass("success")}function formAjaxReply(e){var i=$.parseJSON(e);$resultOutcome="Form mailed successfully"==i?"success":"error",$form.find(".response").removeClass("loading").addClass($resultOutcome).html(i)}!function(e){function i(i){var t=e(this),r=null,l=[],a=null,s=null,n=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},i),o=3,c=300,u=function(e){l.push({x:e.pageX,y:e.pageY}),l.length>o&&l.shift()},m=function(){s&&clearTimeout(s),n.exitMenu(this)&&(r&&n.deactivate(r),r=null)},$=function(){s&&clearTimeout(s),n.enter(this),h(this)},d=function(){n.exit(this)},f=function(){g(this)},g=function(e){e!=r&&(r&&n.deactivate(r),n.activate(e),r=e)},h=function(e){var i=v();i?s=setTimeout(function(){h(e)},i):g(e)},v=function(){function i(e,i){return(i.y-e.y)/(i.x-e.x)}if(!r||!e(r).is(n.submenuSelector))return 0;var s=t.offset(),o={x:s.left,y:s.top-n.tolerance},u={x:s.left+t.outerWidth(),y:o.y},m={x:s.left,y:s.top+t.outerHeight()+n.tolerance},$={x:s.left+t.outerWidth(),y:m.y},d=l[l.length-1],f=l[0];if(!d)return 0;if(f||(f=d),f.x<s.left||f.x>$.x||f.y<s.top||f.y>$.y)return 0;if(a&&d.x==a.x&&d.y==a.y)return 0;var g=u,h=$;"left"==n.submenuDirection?(g=m,h=o):"below"==n.submenuDirection?(g=$,h=m):"above"==n.submenuDirection&&(g=o,h=u);var v=i(d,g),y=i(d,h),p=i(f,g),b=i(f,h);return p>v&&y>b?(a=d,c):(a=null,0)};t.mouseleave(m).find(n.rowSelector).mouseenter($).mouseleave(d).click(f),e(document).mousemove(u)}e.fn.menuAim=function(e){return this.each(function(){i.call(this,e)}),this}}(jQuery);var $navMain_ul=$("#js-main-list"),$navMain_li=$navMain_ul.find("li"),bigScreen=!1;$navMain_ul.mouseenter(function(){vp=updateViewportDimensions(),vp.width>=1030?(bigScreen=!0,$navMain_ul.menuAim({activate:showSubMenu,deactivate:hideSubMenu,exitMenu:hideAllMenus})):bigScreen=!1}),$navMain_li.click(function(){$(this).toggleClass("active-li")});var $carousel=$("#js-carousel-main"),$slide=$carousel.find(".slide"),$tabs=$("#js-carousel-blips > .blip"),slideCount=$slide.length-1,slideTime=8e3,hoverLock=!1,timerLock=!1,tickerInt=0;if($carousel.length>0){var carouselTimer=window.setInterval(ticker,slideTime);$carousel.mouseover(function(){hoverLock=!0}),$carousel.mouseout(function(){hoverLock=!1,clearInterval(carouselTimer),carouselTimer=window.setInterval(ticker,slideTime)}),$tabs.mouseover(function(){hoverLock=!0}),$tabs.mouseout(function(){hoverLock=!1,clearInterval(carouselTimer),carouselTimer=window.setInterval(ticker,slideTime)})}$tabs.click(function(){1==timerLock&&console.log("spam"),tickerInt==$(this).index()||timerLock||(timerLock=!0,tickerInt=$(this).index(),slideActivate(tickerInt))});var MIN_LENGTH=3,$searchForm=$("#js-form-complete").find(".form-search"),$searchIn=$searchForm.find(".search-in"),$searchOut=$searchForm.find(".search-out");$searchIn.keyup(function(){if(vp=updateViewportDimensions(),vp.width>=1030){var e=$(this).val();e.length>=MIN_LENGTH?$.get(fileSrc.admin,{keyword:e,action:"jr_autocomplete"}).done(searchToText):$searchOut.html("")}}),$searchIn.on("keydown",function(e){$results=$searchOut.find("li > a"),"40"==e.keyCode&&$results.length>0&&(e.preventDefault(),searchTraverse("down",-1))}),$searchOut.on("keydown","li > a",function(e){$focussed=$searchOut.find(":focus"),"40"==e.keyCode&&$focussed.length>0?(e.preventDefault(),$i=$(this).parent("li").index(),searchTraverse("down",$i)):"38"==e.keyCode&&$focussed.length>0&&(e.preventDefault(),$i=$(this).parent("li").index(),searchTraverse("up",$i))});var $imgGalleryMain=$("#js-gallery-primary"),$imgGalleryFull=$("#js-gallery-thumbs"),$imgGalleryThumb=$imgGalleryFull.find("li");$imgGalleryPrev=$("#js-gallery-prev"),$imgGalleryNext=$("#js-gallery-next"),$imgGalleryNum=$imgGalleryThumb.length-1,$imgGalleryThumb.click(function(){i=$(this).index(),setMainImg(i)}),$imgGalleryPrev.click(function(){0==$imgGalleryNum&&($imgGalleryNum=$imgGalleryThumb.length),$imgGalleryNum--,console.log($imgGalleryNum),setMainImg($imgGalleryNum)}),$imgGalleryNext.click(function(){$imgGalleryNum==$imgGalleryThumb.length-1&&($imgGalleryNum=-1),$imgGalleryNum++,console.log($imgGalleryNum),setMainImg($imgGalleryNum)});var $imgGalleryModal=$("#js-gallery-modal"),$imgGalleryOpen=$("#js-gallery-zoom"),$imgGalleryClose=$imgGalleryModal.find(".modal-close");$buyModal=$("#js-buy-modal"),$buyModalOpen=$("#js-buy-btn"),$buyModalClose=$buyModal.find(".modal-close"),$queryModal=$("#js-query-modal"),$queryModalOpen=$("#js-query-btn"),$queryModalClose=$queryModal.find(".modal-close"),$imgGalleryOpen.click(function(){$getImgSrc=$imgGalleryMain.find("img").attr("src"),$bigImgSrc=$getImgSrc.replace("gallery-tile","gallery"),$imgGalleryModal.find("img").length?$imgGalleryModal.find("img").attr("src",$bigImgSrc):($bigImgNew='<img class="framed" src="'+$bigImgSrc+'" >',$imgGalleryModal.append($bigImgNew)),modalOpen($imgGalleryModal)}),$imgGalleryClose.click(function(){modalClose($imgGalleryModal)}),$buyModalOpen.click(function(){modalOpenSmall($buyModal)}),$queryModalOpen.click(function(){modalOpenSmall($queryModal)}),$buyModalClose.click(function(){modalClose($buyModal)}),$queryModalClose.click(function(){modalClose($queryModal)});var $queryModalInput=$("#js-question-in").find("option"),$queryModaloutput=$("#js-question-out");$queryModalInput.click(function(){var e=$(this).val();$queryModaloutput.addClass("loading"),$.get(fileSrc.admin,{keyword:e,action:"jr_getAnswers"}).done(questionToText)});var $form=$(".js_contact_form"),$formInputsReq=$form.find(".req"),$formInputsOptional=$form.find(":not(.req)"),$formNextBtn=$form.find(".js_nextBtn"),$formBackBtn=$form.find(".js_backBtn"),$formBlips=$form.next(".form-progress").find(".progress-blip"),formErrorList=[];$form.attr("novalidate",""),$form.submit(function(e){formErrorList=[],$thisForm=$(this),$response=$thisForm.find(".response"),e.preventDefault(),$thisForm.find($formInputsReq).each(function(){$el=$(this),formValidate($el)}),$response.removeClass("success").removeClass("error").empty(),0==formErrorList.length?($response.addClass("loading"),$.get(fileSrc.admin,{keyword:$thisForm.serialize(),action:"jr_formsubmit",url:window.location.href}).done(formAjaxReply)):$response.addClass("error").html("Please fill in required items")}),$formNextBtn.click(function(e){$thisSubForm=$(this).closest("fieldset.subform-active"),$subFormIndex=$thisSubForm.index(),formErrorList=[],$response=$thisSubForm.find(".response"),$thisSubForm.find($formInputsReq).each(function(){$el=$(this),formValidate($el)}),$response.removeClass("success").removeClass("error").empty(),0==formErrorList.length?($thisSubForm.removeClass("subform-active").next("fieldset").addClass("subform-active"),$formBlips.eq($subFormIndex).addClass("active")):$response.addClass("error").html("Please fill in required items")}),$formBackBtn.click(function(e){$thisSubForm=$(this).closest("fieldset.subform-active"),$thisSubForm.removeClass("subform-active").prev("fieldset").addClass("subform-active"),$subFormIndex=$thisSubForm.index(),$formBlips.eq($subFormIndex-1).removeClass("active")}),$formInputsReq.change(function(e){$el=$(this),formValidate($el)}),$formInputsOptional.change(function(e){$el=$(this),$el.val().length>0?$el.addClass("success"):$el.removeClass("success")}),$itemTabFrame=$("#js-tabs-frame"),$itemTabToggle=$itemTabFrame.find(".tab-toggle"),$itemTabToggle.click(function(){$(this).closest("section").toggleClass("active").siblings("section").removeClass("active")});
